# Kubescape Helm Values for VEXxy Premium Service
# This configuration enables runtime analysis and VEX generation

# Enable capabilities for VEX generation and runtime analysis
capabilities:
  vexGeneration: enable
  vulnerabilityScan: enable
  relevancy: enable
  runtimeObservability: enable
  networkEventsStreaming: disable
  configurationScan: disable  # We only need vulnerability analysis

# Node Agent - Required for runtime analysis
nodeAgent:
  enabled: true
  config:
    # Runtime analysis timing (5 minutes)
    applicationActivityTime: 5m
    learningPeriod: 5m
    maxLearningPeriod: 5m
    updatePeriod: 1m
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

# Kubevuln - Vulnerability scanner
kubevuln:
  enabled: true
  config:
    # Store filtered SBOMs (only relevant/reachable components)
    storeFilteredSbom: true
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 2Gi

# Storage - Required for CRDs
storage:
  enabled: true

# Offline vulnerability database
grypeOfflineDB:
  enabled: true

# Operator configuration
operator:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
